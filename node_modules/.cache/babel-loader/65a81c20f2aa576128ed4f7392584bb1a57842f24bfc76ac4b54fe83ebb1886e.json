{"ast":null,"code":"export async function fetchCrimesForLocation(lat, lng, dateYYYYMM = \"\") {\n  const url = new URL(\"https://data.police.uk/api/crimes-street/all-crime\");\n  url.searchParams.set(\"lat\", String(lat));\n  url.searchParams.set(\"lng\", String(lng));\n  if (dateYYYYMM) url.searchParams.set(\"date\", dateYYYYMM);\n  const res = await fetch(url.toString(), {\n    headers: {\n      Accept: \"application/json\"\n    }\n  });\n\n  // UK Police API quirk: 404 often means \"no results for that month/location\"\n  if (res.status === 404) return [];\n  if (!res.ok) {\n    const body = await res.text().catch(() => \"\");\n    let msg = `Police API ${res.status}`;\n    if (body) msg += `: ${body.slice(0, 160)}`;\n    throw new Error(msg);\n  }\n  const json = await res.json().catch(() => []);\n  return Array.isArray(json) ? json : [];\n}","map":{"version":3,"names":["fetchCrimesForLocation","lat","lng","dateYYYYMM","url","URL","searchParams","set","String","res","fetch","toString","headers","Accept","status","ok","body","text","catch","msg","slice","Error","json","Array","isArray"],"sources":["C:/projects/crime-safety-dashboard/src/services/existing.js"],"sourcesContent":["export async function fetchCrimesForLocation(lat, lng, dateYYYYMM = \"\") {\r\n  const url = new URL(\"https://data.police.uk/api/crimes-street/all-crime\");\r\n  url.searchParams.set(\"lat\", String(lat));\r\n  url.searchParams.set(\"lng\", String(lng));\r\n  if (dateYYYYMM) url.searchParams.set(\"date\", dateYYYYMM);\r\n\r\n  const res = await fetch(url.toString(), { headers: { Accept: \"application/json\" } });\r\n\r\n  // UK Police API quirk: 404 often means \"no results for that month/location\"\r\n  if (res.status === 404) return [];\r\n\r\n  if (!res.ok) {\r\n    const body = await res.text().catch(() => \"\");\r\n    let msg = `Police API ${res.status}`;\r\n    if (body) msg += `: ${body.slice(0, 160)}`;\r\n    throw new Error(msg);\r\n  }\r\n\r\n  const json = await res.json().catch(() => []);\r\n  return Array.isArray(json) ? json : [];\r\n}\r\n"],"mappings":"AAAA,OAAO,eAAeA,sBAAsBA,CAACC,GAAG,EAAEC,GAAG,EAAEC,UAAU,GAAG,EAAE,EAAE;EACtE,MAAMC,GAAG,GAAG,IAAIC,GAAG,CAAC,oDAAoD,CAAC;EACzED,GAAG,CAACE,YAAY,CAACC,GAAG,CAAC,KAAK,EAAEC,MAAM,CAACP,GAAG,CAAC,CAAC;EACxCG,GAAG,CAACE,YAAY,CAACC,GAAG,CAAC,KAAK,EAAEC,MAAM,CAACN,GAAG,CAAC,CAAC;EACxC,IAAIC,UAAU,EAAEC,GAAG,CAACE,YAAY,CAACC,GAAG,CAAC,MAAM,EAAEJ,UAAU,CAAC;EAExD,MAAMM,GAAG,GAAG,MAAMC,KAAK,CAACN,GAAG,CAACO,QAAQ,CAAC,CAAC,EAAE;IAAEC,OAAO,EAAE;MAAEC,MAAM,EAAE;IAAmB;EAAE,CAAC,CAAC;;EAEpF;EACA,IAAIJ,GAAG,CAACK,MAAM,KAAK,GAAG,EAAE,OAAO,EAAE;EAEjC,IAAI,CAACL,GAAG,CAACM,EAAE,EAAE;IACX,MAAMC,IAAI,GAAG,MAAMP,GAAG,CAACQ,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,EAAE,CAAC;IAC7C,IAAIC,GAAG,GAAG,cAAcV,GAAG,CAACK,MAAM,EAAE;IACpC,IAAIE,IAAI,EAAEG,GAAG,IAAI,KAAKH,IAAI,CAACI,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;IAC1C,MAAM,IAAIC,KAAK,CAACF,GAAG,CAAC;EACtB;EAEA,MAAMG,IAAI,GAAG,MAAMb,GAAG,CAACa,IAAI,CAAC,CAAC,CAACJ,KAAK,CAAC,MAAM,EAAE,CAAC;EAC7C,OAAOK,KAAK,CAACC,OAAO,CAACF,IAAI,CAAC,GAAGA,IAAI,GAAG,EAAE;AACxC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}